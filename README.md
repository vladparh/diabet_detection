# Выявление диабета с помощью нейросети

В рамках данного проекта планирутся решить задачу выявления диабета с помощью
нейронных сетей. Диабет на сегодняшний день - достаточно распространённое
заболевание, поэтому хотелось бы, чтобы люди, дав ответы на несколько вопросов,
могли узнать, что у них, вероятно, диабет и им нужно обратиться к врачу.

## Структура проекта

```
├───.dvc <- конфиг dvc
│   ├───.gitignore
│   └───config
├───conf <- папка с конфигами
│   ├───data_loading
│   │   └───data_loading.yaml
│   ├───inference
│   │   └───inference.yaml
│   ├───logging
│   │   └───logging.yaml
│   ├───model
│   │   └───model.yaml
│   ├───training
│   │   └───model.yaml
│   └───config.yaml
├───data <- папка с данными
│   ├───.gitignore
│   └───train_data.csv.dvc
├───diabet_detector <- сорцы кода
│   ├───.gitignore
│   ├───data_preprocessing.py
│   ├───logger.py
│   ├───model.py
│   └───trainer.py
├───plots <- графики
├───saved_models <- сохранённые модели
│   ├───model_v1.0
│   │   └───model_val_AP=0.79.ckpt.dvc
│   ├───.gitignore
│   └───scaler.pkl.dvc
├───.dvcignore
├───.gitignore
├───.pre-commit-config.yaml
├───Dockerfile
├───LICENCE
├───README.md
├───infer.py
├───poetry.lock
├───pyproject.toml
├───requiremets.txt
└───train.py
```

## Данные

Был выбран следующий датасет:
https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset/data

В используемом датасете 2 класса: 0 - нет диабета, 1 - преддиабет или диабет, - и 21
признак. Большинство признаков категориальные: представляют из себя ответ на
вопрос (да или нет). Классы сбалансированы. Датасет состоит из 70,692 ответов
респондентов, что должно быть достаточным для тренировки и валидации модели.

## Модель

В качестве модели используется полносвязная нейронная сеть с
нескольким внутренними слоями и одним выходом. Для её реализации использована библиотека `pytorch`. Препроцессинг данных проводится с
помощью библиотеки `scikit-learn`.

## Предсказание

Модель предсказывает вероятность диабета или преддиабета.
Модель можно обернуть в сервис, где пользователь сначала отвечает на вопросы и
потом на основании данных ответов выводится вероятность того, что у него
преддиабет или диабет.

## Начало работы
Для запуска проекта с помощью docker, нужно создать сначала docker-образ:
```
docker build -t diabet_detection .
```
Затем, для запуска, например, infer.py нужно использовать команду:
```
docker run --rm -v "$(pwd)/usr/src/app" diabet_detection python infer.py
```
